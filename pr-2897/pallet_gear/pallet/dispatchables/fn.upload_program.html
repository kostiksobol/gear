<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Creates program initialization request (message), that is scheduled to be run in the same block."><title>upload_program in pallet_gear::pallet::dispatchables - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-ba5701c5741a7b69.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="pallet_gear" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.0-nightly (f5559e338 2023-04-24)" data-search-js="search-618e954b235f6acc.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-6f6ffb5395b17c6e.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../../../static.files/storage-62ce34ea385b278a.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../../../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../../../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../../pallet_gear/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../../pallet_gear/index.html"><img class="rust-logo" src="../../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In pallet_gear::pallet::dispatchables</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../../index.html">pallet_gear</a>::<wbr><a href="../index.html">pallet</a>::<wbr><a href="index.html">dispatchables</a>::<wbr><a class="fn" href="#">upload_program</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../src/pallet_gear/lib.rs.html#180">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub fn upload_program&lt;T: <a class="trait" href="../trait.Config.html" title="trait pallet_gear::pallet::Config">Config</a>&gt;(
    code: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;,
    salt: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;,
    init_payload: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;,
    gas_limit: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>,
    value: &lt;&lt;T as <a class="trait" href="../trait.Config.html" title="trait pallet_gear::pallet::Config">Config</a>&gt;::<a class="associatedtype" href="../trait.Config.html#associatedtype.Currency" title="type pallet_gear::pallet::Config::Currency">Currency</a> as Currency&lt;&lt;T as Config&gt;::AccountId&gt;&gt;::Balance
)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Creates program initialization request (message), that is scheduled to be run in the same block.</p>
<p>There are no guarantees that initialization message will be run in the same block due to block
gas limit restrictions. For example, when it will be the message’s turn, required gas limit for it
could be more than remaining block gas limit. Therefore, the message processing will be postponed
until the next block.</p>
<p><code>ProgramId</code> is computed as Blake256 hash of concatenated bytes of <code>code</code> + <code>salt</code>. (todo #512 <code>code_hash</code> + <code>salt</code>)
Such <code>ProgramId</code> must not exist in the Program Storage at the time of this call.</p>
<p>There is the same guarantee here as in <code>upload_code</code>. That is, future program’s
<code>code</code> and metadata are stored before message was added to the queue and processed.</p>
<p>The origin must be Signed and the sender must have sufficient funds to pay
for <code>gas</code> and <code>value</code> (in case the latter is being transferred).</p>
<p>Parameters:</p>
<ul>
<li><code>code</code>: wasm code of a program as a byte vector.</li>
<li><code>salt</code>: randomness term (a seed) to allow programs with identical code
to be created independently.</li>
<li><code>init_payload</code>: encoded parameters of the wasm module <code>init</code> function.</li>
<li><code>gas_limit</code>: maximum amount of gas the program can spend before it is halted.</li>
<li><code>value</code>: balance to be transferred to the program once it’s been created.</li>
</ul>
<p>Emits the following events:</p>
<ul>
<li><code>InitMessageEnqueued(MessageInfo)</code> when init message is placed in the queue.</li>
</ul>
<h2 id="note"><a href="#note">Note</a></h2>
<p>Faulty (uninitialized) programs still have a valid addresses (program ids) that can deterministically be derived on the
caller’s side upfront. It means that if messages are sent to such an address, they might still linger in the queue.</p>
<p>In order to mitigate the risk of users’ funds being sent to an address,
where a valid program should have resided, while it’s not,
such “failed-to-initialize” programs are not silently deleted from the
program storage but rather marked as “ghost” programs.
Ghost program can be removed by their original author via an explicit call.
The funds stored by a ghost program will be release to the author once the program
has been removed.</p>
<hr />
<p>NOTE: This function is an automatically generated, doc only, uncallable stub.
designed to document the <a href="../enum.Call.html#variant.upload_program" title="variant pallet_gear::pallet::Call::upload_program"><code>upload_program</code></a> variant of
the pallet <a href="../enum.Call.html" title="enum pallet_gear::pallet::Call"><code>Call</code></a> enum. You should not attempt to call this function
directly.</p>
</div></details></section></div></main></body></html>